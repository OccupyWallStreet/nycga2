var jscolor={dir:"",bindClass:"color",binding:true,preloading:true,install:function(){jscolor.addEvent(window,"load",jscolor.init)},init:function(){if(jscolor.binding){jscolor.bind()}if(jscolor.preloading){jscolor.preload()}},getDir:function(){if(!jscolor.dir){var a=jscolor.detectDir();jscolor.dir=a!==false?a:"jscolor/"}return jscolor.dir},detectDir:function(){var c=location.href;var d=document.getElementsByTagName("base");for(var a=0;a<d.length;a+=1){if(d[a].href){c=d[a].href}}var d=document.getElementsByTagName("script");for(var a=0;a<d.length;a+=1){if(d[a].src&&/(^|\/)jscolor\.js([?#].*)?$/i.test(d[a].src)){var f=new jscolor.URI(d[a].src);var b=f.toAbsolute(c);b.path=b.path.replace(/[^\/]+$/,"");b.query=null;b.fragment=null;return b.toString()}}return false},bind:function(){var matchClass=new RegExp("(^|\\s)("+jscolor.bindClass+")\\s*(\\{[^}]*\\})?","i");var e=document.getElementsByTagName("input");for(var i=0;i<e.length;i+=1){var m;if(!e[i].color&&e[i].className&&(m=e[i].className.match(matchClass))){var prop={};if(m[3]){try{eval("prop="+m[3])}catch(eInvalidProp){}}e[i].color=new jscolor.color(e[i],prop)}}},preload:function(){for(var a in jscolor.imgRequire){if(jscolor.imgRequire.hasOwnProperty(a)){jscolor.loadImage(a)}}},images:{pad:[181,101],sld:[16,101],cross:[15,15],arrow:[7,11]},imgRequire:{},imgLoaded:{},requireImage:function(a){jscolor.imgRequire[a]=true},loadImage:function(a){if(!jscolor.imgLoaded[a]){jscolor.imgLoaded[a]=new Image();jscolor.imgLoaded[a].src=jscolor.getDir()+a}},fetchElement:function(a){return typeof a==="string"?document.getElementById(a):a},addEvent:function(a,c,b){if(a.addEventListener){a.addEventListener(c,b,false)}else{if(a.attachEvent){a.attachEvent("on"+c,b)}}},fireEvent:function(a,c){if(!a){return}if(document.createEvent){var b=document.createEvent("HTMLEvents");b.initEvent(c,true,true);a.dispatchEvent(b)}else{if(document.createEventObject){var b=document.createEventObject();a.fireEvent("on"+c,b)}else{if(a["on"+c]){a["on"+c]()}}}},getElementPos:function(c){var d=c,b=c;var a=0,f=0;if(d.offsetParent){do{a+=d.offsetLeft;f+=d.offsetTop}while(d=d.offsetParent)}while((b=b.parentNode)&&b.nodeName.toUpperCase()!=="BODY"){a-=b.scrollLeft;f-=b.scrollTop}return[a,f]},getElementSize:function(a){return[a.offsetWidth,a.offsetHeight]},getRelMousePos:function(b){var a=0,c=0;if(!b){b=window.event}if(typeof b.offsetX==="number"){a=b.offsetX;c=b.offsetY}else{if(typeof b.layerX==="number"){a=b.layerX;c=b.layerY}}return{x:a,y:c}},getViewPos:function(){if(typeof window.pageYOffset==="number"){return[window.pageXOffset,window.pageYOffset]}else{if(document.body&&(document.body.scrollLeft||document.body.scrollTop)){return[document.body.scrollLeft,document.body.scrollTop]}else{if(document.documentElement&&(document.documentElement.scrollLeft||document.documentElement.scrollTop)){return[document.documentElement.scrollLeft,document.documentElement.scrollTop]}else{return[0,0]}}}},getViewSize:function(){if(typeof window.innerWidth==="number"){return[window.innerWidth,window.innerHeight]}else{if(document.body&&(document.body.clientWidth||document.body.clientHeight)){return[document.body.clientWidth,document.body.clientHeight]}else{if(document.documentElement&&(document.documentElement.clientWidth||document.documentElement.clientHeight)){return[document.documentElement.clientWidth,document.documentElement.clientHeight]}else{return[0,0]}}}},URI:function(a){this.scheme=null;this.authority=null;this.path="";this.query=null;this.fragment=null;this.parse=function(d){var c=d.match(/^(([A-Za-z][0-9A-Za-z+.-]*)(:))?((\/\/)([^\/?#]*))?([^?#]*)((\?)([^#]*))?((#)(.*))?/);this.scheme=c[3]?c[2]:null;this.authority=c[5]?c[6]:null;this.path=c[7];this.query=c[9]?c[10]:null;this.fragment=c[12]?c[13]:null;return this};this.toString=function(){var c="";if(this.scheme!==null){c=c+this.scheme+":"}if(this.authority!==null){c=c+"//"+this.authority}if(this.path!==null){c=c+this.path}if(this.query!==null){c=c+"?"+this.query}if(this.fragment!==null){c=c+"#"+this.fragment}return c};this.toAbsolute=function(e){var e=new jscolor.URI(e);var d=this;var c=new jscolor.URI;if(e.scheme===null){return false}if(d.scheme!==null&&d.scheme.toLowerCase()===e.scheme.toLowerCase()){d.scheme=null}if(d.scheme!==null){c.scheme=d.scheme;c.authority=d.authority;c.path=b(d.path);c.query=d.query}else{if(d.authority!==null){c.authority=d.authority;c.path=b(d.path);c.query=d.query}else{if(d.path===""){c.path=e.path;if(d.query!==null){c.query=d.query}else{c.query=e.query}}else{if(d.path.substr(0,1)==="/"){c.path=b(d.path)}else{if(e.authority!==null&&e.path===""){c.path="/"+d.path}else{c.path=e.path.replace(/[^\/]+$/,"")+d.path}c.path=b(c.path)}c.query=d.query}c.authority=e.authority}c.scheme=e.scheme}c.fragment=d.fragment;return c};function b(e){var c="";while(e){if(e.substr(0,3)==="../"||e.substr(0,2)==="./"){e=e.replace(/^\.+/,"").substr(1)}else{if(e.substr(0,3)==="/./"||e==="/."){e="/"+e.substr(3)}else{if(e.substr(0,4)==="/../"||e==="/.."){e="/"+e.substr(4);c=c.replace(/\/?[^\/]*$/,"")}else{if(e==="."||e===".."){e=""}else{var d=e.match(/^\/?[^\/]*/)[0];e=e.substr(d.length);c=c+d}}}}}return c}if(a){this.parse(a)}},color:function(z,d){this.required=true;this.adjust=true;this.hash=false;this.caps=true;this.slider=true;this.valueElement=z;this.styleElement=z;this.hsv=[0,0,1];this.rgb=[1,1,1];this.pickerOnfocus=true;this.pickerMode="HSV";this.pickerPosition="bottom";this.pickerButtonHeight=20;this.pickerClosable=false;this.pickerCloseText="Close";this.pickerButtonColor="ButtonText";this.pickerFace=10;this.pickerFaceColor="ThreeDFace";this.pickerBorder=1;this.pickerBorderColor="ThreeDHighlight ThreeDShadow ThreeDShadow ThreeDHighlight";this.pickerInset=1;this.pickerInsetColor="ThreeDShadow ThreeDHighlight ThreeDHighlight ThreeDShadow";this.pickerZIndex=10000;for(var q in d){if(d.hasOwnProperty(q)){this[q]=d[q]}}this.hidePicker=function(){if(s()){f()}};this.showPicker=function(){if(!s()){var I=jscolor.getElementPos(z);var F=jscolor.getElementSize(z);var C=jscolor.getViewPos();var K=jscolor.getViewSize();var p=r(this);var J,H,G;switch(this.pickerPosition.toLowerCase()){case"left":J=1;H=0;G=-1;break;case"right":J=1;H=0;G=1;break;case"top":J=0;H=1;G=-1;break;default:J=0;H=1;G=1;break}var E=(F[H]+p[H])/2;var D=[-C[J]+I[J]+p[J]>K[J]?(-C[J]+I[J]+F[J]/2>K[J]/2&&I[J]+F[J]-p[J]>=0?I[J]+F[J]-p[J]:I[J]):I[J],-C[H]+I[H]+F[H]+p[H]-E+E*G>K[H]?(-C[H]+I[H]+F[H]/2>K[H]/2&&I[H]+F[H]-E-E*G>=0?I[H]+F[H]-E-E*G:I[H]+F[H]-E+E*G):(I[H]+F[H]-E+E*G>=0?I[H]+F[H]-E+E*G:I[H]+F[H]-E-E*G)];i(D[J],D[H])}};this.importColor=function(){if(!a){this.exportColor()}else{if(!this.adjust){if(!this.fromString(a.value,v)){B.style.backgroundColor=B.jscStyle.backgroundColor;B.style.color=B.jscStyle.color;this.exportColor(v|A)}}else{if(!this.required&&/^\s*$/.test(a.value)){a.value="";B.style.backgroundColor=B.jscStyle.backgroundColor;B.style.color=B.jscStyle.color;this.exportColor(v|A)}else{if(this.fromString(a.value)){}else{this.exportColor()}}}}};this.exportColor=function(p){if(!(p&v)&&a){var C=this.toString();if(this.caps){C=C.toUpperCase()}if(this.hash){C="#"+C}a.value=C}if(!(p&A)&&B){B.style.backgroundColor="#"+this.toString();B.style.color=0.213*this.rgb[0]+0.715*this.rgb[1]+0.072*this.rgb[2]<0.5?"#FFF":"#000"}if(!(p&t)&&s()){o()}if(!(p&e)&&s()){y()}};this.fromHSV=function(E,D,C,p){E<0&&(E=0)||E>6&&(E=6);D<0&&(D=0)||D>1&&(D=1);C<0&&(C=0)||C>1&&(C=1);this.rgb=g(E===null?this.hsv[0]:(this.hsv[0]=E),D===null?this.hsv[1]:(this.hsv[1]=D),C===null?this.hsv[2]:(this.hsv[2]=C));this.exportColor(p)};this.fromRGB=function(F,E,p,C){F<0&&(F=0)||F>1&&(F=1);E<0&&(E=0)||E>1&&(E=1);p<0&&(p=0)||p>1&&(p=1);var D=w(F===null?this.rgb[0]:(this.rgb[0]=F),E===null?this.rgb[1]:(this.rgb[1]=E),p===null?this.rgb[2]:(this.rgb[2]=p));if(D[0]!==null){this.hsv[0]=D[0]}if(D[2]!==0){this.hsv[1]=D[1]}this.hsv[2]=D[2];this.exportColor(C)};this.fromString=function(D,C){var p=D.match(/^\W*([0-9A-F]{3}([0-9A-F]{3})?)\W*$/i);if(!p){return false}else{if(p[1].length===6){this.fromRGB(parseInt(p[1].substr(0,2),16)/255,parseInt(p[1].substr(2,2),16)/255,parseInt(p[1].substr(4,2),16)/255,C)}else{this.fromRGB(parseInt(p[1].charAt(0)+p[1].charAt(0),16)/255,parseInt(p[1].charAt(1)+p[1].charAt(1),16)/255,parseInt(p[1].charAt(2)+p[1].charAt(2),16)/255,C)}return true}};this.toString=function(){return((256|Math.round(255*this.rgb[0])).toString(16).substr(1)+(256|Math.round(255*this.rgb[1])).toString(16).substr(1)+(256|Math.round(255*this.rgb[2])).toString(16).substr(1))};function w(G,F,C){var H=Math.min(Math.min(G,F),C);var D=Math.max(Math.max(G,F),C);var p=D-H;if(p===0){return[null,0,D]}var E=G===H?3+(C-F)/p:(F===H?5+(G-C)/p:1+(F-G)/p);return[E===6?0:E,p/D,D]}function g(F,E,C){if(F===null){return[C,C,C]}var D=Math.floor(F);var G=D%2?F-D:1-(F-D);var p=C*(1-E);var H=C*(1-E*G);switch(D){case 6:case 0:return[C,H,p];case 1:return[H,C,p];case 2:return[p,C,H];case 3:return[p,H,C];case 4:return[H,p,C];case 5:return[C,p,H]}}function f(){delete jscolor.picker.owner;document.getElementsByTagName("body")[0].removeChild(jscolor.picker.boxB)}function i(J,I){if(!jscolor.picker){jscolor.picker={box:document.createElement("div"),boxB:document.createElement("div"),pad:document.createElement("div"),padB:document.createElement("div"),padM:document.createElement("div"),sld:document.createElement("div"),sldB:document.createElement("div"),sldM:document.createElement("div"),btn:document.createElement("div"),btnS:document.createElement("span"),btnT:document.createTextNode(j.pickerCloseText)};for(var G=0,H=4;G<jscolor.images.sld[1];G+=H){var F=document.createElement("div");F.style.height=H+"px";F.style.fontSize="1px";F.style.lineHeight="0";jscolor.picker.sld.appendChild(F)}jscolor.picker.sldB.appendChild(jscolor.picker.sld);jscolor.picker.box.appendChild(jscolor.picker.sldB);jscolor.picker.box.appendChild(jscolor.picker.sldM);jscolor.picker.padB.appendChild(jscolor.picker.pad);jscolor.picker.box.appendChild(jscolor.picker.padB);jscolor.picker.box.appendChild(jscolor.picker.padM);jscolor.picker.btnS.appendChild(jscolor.picker.btnT);jscolor.picker.btn.appendChild(jscolor.picker.btnS);jscolor.picker.box.appendChild(jscolor.picker.btn);jscolor.picker.boxB.appendChild(jscolor.picker.box)}var C=jscolor.picker;C.box.onmouseup=C.box.onmouseout=function(){z.focus()};C.box.onmousedown=function(){l=true};C.box.onmousemove=function(p){if(c||m){c&&u(p);m&&h(p);if(document.selection){document.selection.empty()}else{if(window.getSelection){window.getSelection().removeAllRanges()}}}};C.padM.onmouseup=C.padM.onmouseout=function(){if(c){c=false;jscolor.fireEvent(a,"change")}};C.padM.onmousedown=function(p){c=true;u(p)};C.sldM.onmouseup=C.sldM.onmouseout=function(){if(m){m=false;jscolor.fireEvent(a,"change")}};C.sldM.onmousedown=function(p){m=true;h(p)};var L=r(j);C.box.style.width=L[0]+"px";C.box.style.height=L[1]+"px";C.boxB.style.position="absolute";C.boxB.style.clear="both";C.boxB.style.left=J+"px";C.boxB.style.top=I+"px";C.boxB.style.zIndex=j.pickerZIndex;C.boxB.style.border=j.pickerBorder+"px solid";C.boxB.style.borderColor=j.pickerBorderColor;C.boxB.style.background=j.pickerFaceColor;C.pad.style.width=jscolor.images.pad[0]+"px";C.pad.style.height=jscolor.images.pad[1]+"px";C.padB.style.position="absolute";C.padB.style.left=j.pickerFace+"px";C.padB.style.top=j.pickerFace+"px";C.padB.style.border=j.pickerInset+"px solid";C.padB.style.borderColor=j.pickerInsetColor;C.padM.style.position="absolute";C.padM.style.left="0";C.padM.style.top="0";C.padM.style.width=j.pickerFace+2*j.pickerInset+jscolor.images.pad[0]+jscolor.images.arrow[0]+"px";C.padM.style.height=C.box.style.height;C.padM.style.cursor="crosshair";C.sld.style.overflow="hidden";C.sld.style.width=jscolor.images.sld[0]+"px";C.sld.style.height=jscolor.images.sld[1]+"px";C.sldB.style.display=j.slider?"block":"none";C.sldB.style.position="absolute";C.sldB.style.right=j.pickerFace+"px";C.sldB.style.top=j.pickerFace+"px";C.sldB.style.border=j.pickerInset+"px solid";C.sldB.style.borderColor=j.pickerInsetColor;C.sldM.style.display=j.slider?"block":"none";C.sldM.style.position="absolute";C.sldM.style.right="0";C.sldM.style.top="0";C.sldM.style.width=jscolor.images.sld[0]+jscolor.images.arrow[0]+j.pickerFace+2*j.pickerInset+"px";C.sldM.style.height=C.box.style.height;try{C.sldM.style.cursor="pointer"}catch(E){C.sldM.style.cursor="hand"}function K(){var p=j.pickerInsetColor.split(/\s+/);var M=p.length<2?p[0]:p[1]+" "+p[0]+" "+p[0]+" "+p[1];C.btn.style.borderColor=M}C.btn.style.display=j.pickerClosable?"block":"none";C.btn.style.position="absolute";C.btn.style.left=j.pickerFace+"px";C.btn.style.bottom=j.pickerFace+"px";C.btn.style.padding="0 15px";C.btn.style.height="18px";C.btn.style.border=j.pickerInset+"px solid";K();C.btn.style.color=j.pickerButtonColor;C.btn.style.font="12px sans-serif";C.btn.style.textAlign="center";try{C.btn.style.cursor="pointer"}catch(E){C.btn.style.cursor="hand"}C.btn.onmousedown=function(){j.hidePicker()};C.btnS.style.lineHeight=C.btn.style.height;switch(b){case 0:var D="hs.png";break;case 1:var D="hv.png";break}C.padM.style.backgroundImage="url('"+jscolor.getDir()+"cross.gif')";C.padM.style.backgroundRepeat="no-repeat";C.sldM.style.backgroundImage="url('"+jscolor.getDir()+"arrow.gif')";C.sldM.style.backgroundRepeat="no-repeat";C.pad.style.backgroundImage="url('"+jscolor.getDir()+D+"')";C.pad.style.backgroundRepeat="no-repeat";C.pad.style.backgroundPosition="0 0";o();y();jscolor.picker.owner=j;document.getElementsByTagName("body")[0].appendChild(C.boxB)}function r(C){var p=[2*C.pickerInset+2*C.pickerFace+jscolor.images.pad[0]+(C.slider?2*C.pickerInset+2*jscolor.images.arrow[0]+jscolor.images.sld[0]:0),C.pickerClosable?4*C.pickerInset+3*C.pickerFace+jscolor.images.pad[1]+C.pickerButtonHeight:2*C.pickerInset+2*C.pickerFace+jscolor.images.pad[1]];return p}function o(){switch(b){case 0:var E=1;break;case 1:var E=2;break}var I=Math.round((j.hsv[0]/6)*(jscolor.images.pad[0]-1));var H=Math.round((1-j.hsv[E])*(jscolor.images.pad[1]-1));jscolor.picker.padM.style.backgroundPosition=(j.pickerFace+j.pickerInset+I-Math.floor(jscolor.images.cross[0]/2))+"px "+(j.pickerFace+j.pickerInset+H-Math.floor(jscolor.images.cross[1]/2))+"px";var p=jscolor.picker.sld.childNodes;switch(b){case 0:var G=g(j.hsv[0],j.hsv[1],1);for(var C=0;C<p.length;C+=1){p[C].style.backgroundColor="rgb("+(G[0]*(1-C/p.length)*100)+"%,"+(G[1]*(1-C/p.length)*100)+"%,"+(G[2]*(1-C/p.length)*100)+"%)"}break;case 1:var G,J,F=[j.hsv[2],0,0];var C=Math.floor(j.hsv[0]);var D=C%2?j.hsv[0]-C:1-(j.hsv[0]-C);switch(C){case 6:case 0:G=[0,1,2];break;case 1:G=[1,0,2];break;case 2:G=[2,0,1];break;case 3:G=[2,1,0];break;case 4:G=[1,2,0];break;case 5:G=[0,2,1];break}for(var C=0;C<p.length;C+=1){J=1-1/(p.length-1)*C;F[1]=F[0]*(1-J*D);F[2]=F[0]*(1-J);p[C].style.backgroundColor="rgb("+(F[G[0]]*100)+"%,"+(F[G[1]]*100)+"%,"+(F[G[2]]*100)+"%)"}break}}function y(){switch(b){case 0:var p=2;break;case 1:var p=1;break}var C=Math.round((1-j.hsv[p])*(jscolor.images.sld[1]-1));jscolor.picker.sldM.style.backgroundPosition="0 "+(j.pickerFace+j.pickerInset+C-Math.floor(jscolor.images.arrow[1]/2))+"px"}function s(){return jscolor.picker&&jscolor.picker.owner===j}function n(){if(a===z){j.importColor()}if(j.pickerOnfocus){j.hidePicker()}}function k(){if(a!==z){j.importColor()}}function u(D){var C=jscolor.getRelMousePos(D);var p=C.x-j.pickerFace-j.pickerInset;var E=C.y-j.pickerFace-j.pickerInset;switch(b){case 0:j.fromHSV(p*(6/(jscolor.images.pad[0]-1)),1-E/(jscolor.images.pad[1]-1),null,e);break;case 1:j.fromHSV(p*(6/(jscolor.images.pad[0]-1)),null,1-E/(jscolor.images.pad[1]-1),e);break}}function h(C){var p=jscolor.getRelMousePos(C);var D=p.y-j.pickerFace-j.pickerInset;switch(b){case 0:j.fromHSV(null,null,1-D/(jscolor.images.sld[1]-1),t);break;case 1:j.fromHSV(null,1-D/(jscolor.images.sld[1]-1),null,t);break}}var j=this;var b=this.pickerMode.toLowerCase()==="hvs"?1:0;var l=false;var a=jscolor.fetchElement(this.valueElement),B=jscolor.fetchElement(this.styleElement);var c=false,m=false;var v=1<<0,A=1<<1,t=1<<2,e=1<<3;jscolor.addEvent(z,"focus",function(){if(j.pickerOnfocus){j.showPicker()}});jscolor.addEvent(z,"blur",function(){if(!l){window.setTimeout(function(){l||n();l=false},0)}else{l=false}});if(a){var x=function(){j.fromString(a.value,v)};jscolor.addEvent(a,"keyup",x);jscolor.addEvent(a,"input",x);jscolor.addEvent(a,"blur",k);a.setAttribute("autocomplete","off")}if(B){B.jscStyle={backgroundColor:B.style.backgroundColor,color:B.style.color}}switch(b){case 0:jscolor.requireImage("hs.png");break;case 1:jscolor.requireImage("hv.png");break}jscolor.requireImage("cross.gif");jscolor.requireImage("arrow.gif");this.importColor()}};jscolor.install();