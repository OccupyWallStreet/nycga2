function sfjtoggleThread(cCell,targetDiv,rowIndex){jQuery('#'+targetDiv).toggle('slow');var n1=cCell.parentNode;var n2=n1.parentNode;var n3=n2.parentNode;var n4=n3.parentNode;var n5=n4.parentNode;var cRow=n5.parentNode;if(cRow.className=="sfpmshow"){cRow.className="sfpmread"}else{cRow.className="sfpmshow"}}curId=0;function sfjgetPMText(imageFile,url,pmId,box,status){if(curId!=pmId){var messageTarget='sfpmmsg';var infoTarget='sfpminfo';var buttonsTarget='sfpmbuttons';var content=document.getElementById(messageTarget);var info=document.getElementById(infoTarget);var buttons=document.getElementById(buttonsTarget);if(curId!=0){var oldTarget='message-'+curId;var oldrow=document.getElementById(oldTarget);oldrow.className='sfpmread'}var newTarget='message-'+pmId;var newrow=document.getElementById(newTarget);newrow.className='sfpmselected';curId=pmId;content.style.display='block';info.style.display='block';buttons.style.display='block';buttons.style.paddingTop='5px';content.innerHTML='<br /><br /><img src="'+imageFile+'" /><br />';buttonUrl=url+'&pmbuttons='+pmId+'&pmaction='+box;jQuery('#'+buttonsTarget).load(buttonUrl);infoUrl=url+'&pminfo='+pmId+'&pmaction='+box;jQuery('#'+infoTarget).load(infoUrl);messageUrl=url+'&pmshow='+pmId+'&pmaction='+box;jQuery('#'+messageTarget).load(messageUrl);if(status=='0'){var counter=document.getElementById('sfunreadpm');var pcount=parseInt(counter.innerHTML);if(isNaN(pcount)||pcount==0){pcount=0}else{pcount--}counter.style.color='#ffffff';counter.innerHTML=pcount}}}function sfjsendPMTo(recipient,name,title,reply,slug,editor){document.getElementById('pmtonamelist').innerHTML='';document.getElementById('pmcount').value=0;jQuery('#sfpostform').show(function(){document.getElementById('sfpostform').scrollIntoView();if(editor==2||editor==3||editor==4){document.addpm.postitem.value='';document.addpm.postitem.focus()}if(editor==1){if(jQuery.browser.mozilla||jQuery.browser.opera){tinyMCE.activeEditor.selection.setContent('');tinyMCE.activeEditor.focus()}if(jQuery.browser.safari||jQuery.browser.webkit){tinyMCE.activeEditor.execCommand("InsertHTML",false,'')}if(jQuery.browser.msie){tinyMCE.activeEditor.execCommand("mceInsertRawHTML",false,'');tinyMCE.activeEditor.focus()}}});if(recipient){namelist=name.split(",");recipientlist=recipient.split(",");for(x=recipientlist.length-1;x>=0;x--){sfjpmaddrecipient(namelist[x],recipientlist[x])}}document.getElementById('pmtitle').value=title;document.getElementById('pmoldtitle').value=title;document.getElementById('pmreply').value=reply;document.getElementById('pmslug').value=slug;if(document.getElementById('sfpostform').style.display!="block"){sfjtoggleLayer('sfpostform')}return false}function sfjpmallusers(){var uid=document.getElementById('uid').value;var rList='';for(i=uid-1;i>0;i--){var user=document.getElementById('userid'+i);if(user!=null){sfjpmremoveuser(user)}}document.getElementById('pmtonamelist').innerHTML='';document.getElementById('pmcount').value=1;sfjpmaddrecipient('All Users',-1);document.getElementById('pmall').value=1;var addbuddy=document.getElementById('addbuddy');addbuddy.style.display="none";return false}function sfjquotePM(recipient,pmid,intro,editor,name,title,reply,slug){var postcontent=document.getElementById('sfpmmsg').innerHTML;jQuery('#sfpostform').show(function(){document.getElementById('sfpostform').scrollIntoView();if(editor==2||editor==4){document.addpm.postitem.value='<strong>'+intro+'</strong>\r\r'+'<blockquote>'+postcontent+'</blockquote><br />\r\r';document.addpm.postitem.focus()}if(editor==3){document.addpm.postitem.value='[b]'+intro+'[/b]\r\r[quote]'+postcontent+'[/quote]\r\r';document.addpm.postitem.focus()}if(editor==1){if(jQuery.browser.mozilla||jQuery.browser.opera){tinyMCE.activeEditor.selection.setContent('<strong>'+intro+'</strong><blockquote>'+postcontent+'</blockquote><br />');tinyMCE.activeEditor.focus()}if(jQuery.browser.safari||jQuery.browser.webkit){tinyMCE.activeEditor.execCommand("InsertHTML",false,'<strong>'+intro+'</strong><blockquote>'+postcontent+'</blockquote><br />')}if(jQuery.browser.msie){tinyMCE.activeEditor.execCommand("mceInsertRawHTML",false,'<strong>'+intro+'</strong><blockquote>'+postcontent+'</blockquote><br />');tinyMCE.activeEditor.focus()}}});sfjsendPMTo(recipient,name,title,reply,slug)}function sfjdeleteThread(cCell,url,rowIndex,targetDiv){var pmTable=document.getElementById('sfmainpmtable');var target=pmTable.rows[rowIndex];var n1=cCell.parentNode;var cRow=n1.parentNode;if(cRow.className=="sfpmshow"){sfjtoggleLayer(targetDiv)}if(navigator.appName=="Microsoft Internet Explorer"){sfjopacity(target.style,9,0,10,function(){sfjremoveIt(target)})}else{sfjopacity(target.style,199,0,10,function(){sfjhideIt(target)})}jQuery('#sfdummy').load(url)}function sfjdeletePM(cCell,messageUrl,threadUrl,rowIndex,threadRowIndex,threadDiv,threadSlug){var pmTable=document.getElementById('sfmessagetable-'+threadSlug);var target=pmTable.rows[rowIndex];msgDiv=document.getElementById('sfpm'+threadSlug);if(navigator.appName=="Microsoft Internet Explorer"){sfjopacity(target.style,9,0,10,function(){sfjremoveIt(target)})}else{sfjopacity(target.style,199,0,10,function(){sfjhideIt(target)})}var threadCount=document.getElementById('pm-'+threadSlug+'count');var pcount=parseInt(threadCount.innerHTML);if(isNaN(pcount)){return}else{pcount--;threadCount.innerHTML=pcount}if(pcount==0){var threadCell=document.getElementById('pm-'+threadSlug+'delthread');sfjdeleteThread(threadCell,threadUrl,threadRowIndex,threadDiv)}else{jQuery('#sfdummy').load(messageUrl)}}function sfjdeleteMassPM(url){var pmTable=document.getElementById('sfmainpmtable');if(navigator.appName=="Microsoft Internet Explorer"){sfjopacity(pmTable.style,9,0,10,function(){sfjremoveIt(pmTable)})}else{sfjopacity(pmTable.style,199,0,10,function(){sfjhideIt(pmTable)})}jQuery('#sfdummy').load(url)}function sfjmarkUnread(url,id,text){if(curId!=0){var msg=document.getElementById('sfpmmsg-'+id);msg.style.visibility="";msg.style.display="block";msg.className='sfpmunread sfxcontrol';msg.innerHTML=text;if(navigator.appName=="Microsoft Internet Explorer"){sfjopacity(msg.style,9,0,10,function(){sfjremoveIt(msg)})}else{sfjopacity(msg.style,199,0,10,function(){sfjhideIt(msg)})}var oldTarget='message-'+id;var oldrow=document.getElementById(oldTarget);oldrow.className='sfpmunread';curId=0;jQuery('#sfdummy').load(url);var counter=document.getElementById('sfunreadpm');var pcount=parseInt(counter.innerHTML);if(isNaN(pcount)){pcount=1}else{pcount++}counter.style.color='#ffffff';counter.innerHTML=pcount}}function sfjpmaddbuddies(){var uid=document.getElementById('uid').value;var url=document.getElementById('pmsite').value;var rList='';for(i=uid-1;i>0;i--){var user=document.getElementById('userid'+i);if(user!=null){if(rList==''){rList=user.value}else{rList=rList+'-'+user.value}}}if((rList==null)||(rList=='0')){return}url+='&addbuddy='+rList;jQuery('#pmbuddies').load(url)}function sfjpmnewbuddy(uid){var url=document.getElementById('pmsite').value;var user=document.getElementById('userid'+uid);rList=user.value;url+='&addbuddy='+rList;jQuery('#pmbuddies').load(url)}function sfjpmaddbuddy(source){var source=document.getElementById(source);var uid=document.getElementById('uid').value;var found=false;for(i=uid-1;i>0;i--){var user=document.getElementById('userid'+i);if(user!=null&&user.value==source.value){found=true;break}}if(!found){var thisOption=new Option(source.options[source.selectedIndex].text,source.value,true,true);sfjpmaddrecipient(thisOption.text,source.value)}return false}function sfjpmadduser(li){var uid=document.getElementById('uid').value;var found=false;for(i=uid-1;i>0;i--){var user=document.getElementById('userid'+i);if(user!=null&&user.value==li.extra){found=true;break}}if(!found){sfjpmaddrecipient(li.selectValue,li.extra)}var tolist=document.getElementById('pmusers');tolist.value='';return false}function sfjpmaddrecipient(rid,ruid){var uid=document.getElementById('uid').value;var img1=document.getElementById('pmdelimage').value;var img2=document.getElementById('pmaddimage').value;var img1msg=document.getElementById('pmdelmsg').value;var img2msg=document.getElementById('pmaddmsg').value;var cc=document.getElementById('pmcc').value;var bcc=document.getElementById('pmbcc').value;var max=document.getElementById('pmmax').value;var count=parseInt(document.getElementById('pmcount').value);var limited=document.getElementById('pmlimited').value;var pmall=document.getElementById('pmall').value;if((max==0||count<max)&&pmall==0){var images="<a href='#' onclick='sfjpmremoveuser(\"#row"+uid+"\"); return false;'> <img src='"+img1+"' title='"+img1msg+"' /></a>";if(ruid!=-1){var images=images+"<a href='#' onclick='sfjpmnewbuddy("+uid+"); return false;'>&nbsp;&nbsp;<img src='"+img2+"' title='"+img2msg+"' /></a>"}if(limited){images=''}cctext=bcctext='';if(cc==1)cctext="<option value='2'>Cc:</option>";if(bcc==1)bcctext="<option value='3'>Bcc:</option>";jQuery("#pmtonamelist").append("<div id='row"+uid+"' style='text-align:center'><select class='sfcontrol' size='1' name='type[]' id='type"+uid+"'><option value='1' default='default'>To:</option>"+cctext+bcctext+"</select> <input class='sfcontrol' type='text' size='30' name='user[]' id='user"+uid+"' value='"+rid+"'><input type='hidden' name='userid[]' id='userid"+uid+"' value='"+ruid+"'>"+images+"</div>");uid=(uid-1)+2;document.getElementById('uid').value=uid;document.getElementById('pmcount').value=(count+1)}else{if(pmall==0){var target=document.getElementById('sfpmexceed');target.innerHTML=document.getElementById('pmmaxmsg').value;var box=hs.htmlExpand(document.getElementById('pmmaxmsg'),{contentId:'pm-tolist',preserveContent:true})}}}function sfjpmremoveuser(ruid){jQuery(ruid).remove();var count=parseInt(document.getElementById('pmcount').value);document.getElementById('pmcount').value=(count-1);document.getElementById('pmall').value=0}